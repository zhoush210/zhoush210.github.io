---
layout: post
title:  "C++ Primer：类设计者的工具"
subtitle: "第三部分"
date:   2023-5-24 15:20:00 +0800
author:     "ZhouSh"
header-img: "img/bg-guidao9.jpg"
header-mask: 0.2
tags:
    - C++
---

## 十三、拷贝控制

**拷贝构造函数**的第一个参数是自身类类型的引用（最好是const &），且任何额外参数都有默认值。`Foo(const Foo&)`。它的作用是用一个对象构造新的对象。如果我们没有为一个类定义拷贝构造函数，编译器会自动定义一个。

如果一个类需要自定义**析构函数**，几乎可以肯定它也需要自定义**拷贝赋值运算符**和**拷贝构造函数**。

如果一个类需要一个**拷贝构造函数**，几乎可以肯定它也需要一个**拷贝赋值运算符**。反之亦然。

我们可以通过将拷贝控制成员定义为`=default`来显式地要求编译器生成合成的版本。

我们可以通过在函数的参数列表后面加上`=delete`将拷贝构造函数和拷贝赋值运算符定义为**删除的函数**（deleted function）来阻止拷贝。即虽然声明了它们，但不能以任何方式使用它们。

**析构函数**不能是删除的成员，否则无法销毁此类型的对象。

对于有**引用**成员的类，合成拷贝赋值运算符应该被定义为**删除**的。因为虽然我们可以将一个新值赋予一个引用成员，但这样做改变的是引用指向的对象的值，而不是引用本身。